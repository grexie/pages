{"version":3,"file":"index.js","names":["config","nextConfigWebpack","webpack","MetadataWebpackConfig","context","module","rules","unshift","type","test","use","loader","options","presets","modules","sourceMaps","devtool","compact","transform","doc","page"],"sources":["../src/index.ts"],"sourcesContent":["import { NextConfig } from 'next';\nimport type { Configuration } from 'webpack';\n\nexport default () => (config: NextConfig) => {\n  const nextConfigWebpack = config.webpack;\n\n  config.webpack = function MetadataWebpackConfig(\n    config: Configuration,\n    context: any\n  ) {\n    config = nextConfigWebpack?.(config, context) ?? config;\n\n    config.module?.rules?.unshift(\n      {\n        type: 'javascript/esm',\n        test: /\\.pages\\.[cm]?jsx?$/,\n        use: [\n          '@grexie/pages-metadata-loader',\n          {\n            loader: 'babel-loader',\n            options: {\n              presets: ['@babel/react', ['@babel/env', { modules: false }]],\n              sourceMaps: !!config.devtool,\n              compact: false,\n            },\n          },\n        ],\n      },\n      {\n        type: 'javascript/esm',\n        test: /\\.pages\\.[cm]?tsx?$/,\n        use: [\n          '@grexie/pages-metadata-loader',\n          {\n            loader: 'babel-loader',\n            options: {\n              presets: [\n                '@babel/typescript',\n                '@babel/react',\n                ['@babel/env', { modules: false }],\n              ],\n              sourceMaps: !!config.devtool,\n              compact: false,\n            },\n          },\n        ],\n      },\n      {\n        type: 'javascript/esm',\n        test: /\\.pages\\.ya?ml$/,\n        use: [\n          '@grexie/pages-metadata-loader',\n          {\n            loader: '@grexie/pages-yaml-loader',\n            options: {\n              transform: (doc: any) => {\n                delete doc.page;\n                return doc;\n              },\n            },\n          },\n        ],\n      },\n      {\n        type: 'javascript/esm',\n        test: /\\.pages\\.json$/,\n        use: [\n          '@grexie/pages-metadata-loader',\n          {\n            loader: '@grexie/pages-json-loader',\n            options: {\n              transform: (doc: any) => {\n                delete doc.page;\n                return doc;\n              },\n            },\n          },\n        ],\n      }\n    );\n\n    return config;\n  };\n  return config;\n};\n"],"mappings":"AAGA,gBAAe,MAAOA,MAAkB,IAAK;EAC3C,MAAMC,iBAAiB,GAAGD,MAAM,CAACE,OAAO;EAExCF,MAAM,CAACE,OAAO,GAAG,SAASC,qBAAqBA,CAC7CH,MAAqB,EACrBI,OAAY,EACZ;IACAJ,MAAM,GAAGC,iBAAiB,GAAGD,MAAM,EAAEI,OAAO,CAAC,IAAIJ,MAAM;IAEvDA,MAAM,CAACK,MAAM,EAAEC,KAAK,EAAEC,OAAO,CAC3B;MACEC,IAAI,EAAE,gBAAgB;MACtBC,IAAI,EAAE,qBAAqB;MAC3BC,GAAG,EAAE,CACH,+BAA+B,EAC/B;QACEC,MAAM,EAAE,cAAc;QACtBC,OAAO,EAAE;UACPC,OAAO,EAAE,CAAC,cAAc,EAAE,CAAC,YAAY,EAAE;YAAEC,OAAO,EAAE;UAAM,CAAC,CAAC,CAAC;UAC7DC,UAAU,EAAE,CAAC,CAACf,MAAM,CAACgB,OAAO;UAC5BC,OAAO,EAAE;QACX;MACF,CAAC;IAEL,CAAC,EACD;MACET,IAAI,EAAE,gBAAgB;MACtBC,IAAI,EAAE,qBAAqB;MAC3BC,GAAG,EAAE,CACH,+BAA+B,EAC/B;QACEC,MAAM,EAAE,cAAc;QACtBC,OAAO,EAAE;UACPC,OAAO,EAAE,CACP,mBAAmB,EACnB,cAAc,EACd,CAAC,YAAY,EAAE;YAAEC,OAAO,EAAE;UAAM,CAAC,CAAC,CACnC;UACDC,UAAU,EAAE,CAAC,CAACf,MAAM,CAACgB,OAAO;UAC5BC,OAAO,EAAE;QACX;MACF,CAAC;IAEL,CAAC,EACD;MACET,IAAI,EAAE,gBAAgB;MACtBC,IAAI,EAAE,iBAAiB;MACvBC,GAAG,EAAE,CACH,+BAA+B,EAC/B;QACEC,MAAM,EAAE,2BAA2B;QACnCC,OAAO,EAAE;UACPM,SAAS,EAAGC,GAAQ,IAAK;YACvB,OAAOA,GAAG,CAACC,IAAI;YACf,OAAOD,GAAG;UACZ;QACF;MACF,CAAC;IAEL,CAAC,EACD;MACEX,IAAI,EAAE,gBAAgB;MACtBC,IAAI,EAAE,gBAAgB;MACtBC,GAAG,EAAE,CACH,+BAA+B,EAC/B;QACEC,MAAM,EAAE,2BAA2B;QACnCC,OAAO,EAAE;UACPM,SAAS,EAAGC,GAAQ,IAAK;YACvB,OAAOA,GAAG,CAACC,IAAI;YACf,OAAOD,GAAG;UACZ;QACF;MACF,CAAC;IAEL,CACF,CAAC;IAED,OAAOnB,MAAM;EACf,CAAC;EACD,OAAOA,MAAM;AACf,CAAC"}