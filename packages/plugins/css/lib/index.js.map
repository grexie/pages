{"version":3,"file":"index.js","names":["CssPagesPlugin","CssNextPlugin","config","nextConfigWebpack","webpack","CssWebpackConfig","context","module","rules","unshift","type","test","use","loader","options","esModule","sourceMap","include","modules","process","env","NODE_ENV","localIdentName"],"sources":["../src/index.ts"],"sourcesContent":["import { NextConfig } from 'next';\nimport { Configuration } from 'webpack';\nexport type { StyleSheet } from '@grexie/pages-runtime-styles';\n\nexport default function CssPagesPlugin() {\n  return function CssNextPlugin(config: NextConfig) {\n    const nextConfigWebpack = config.webpack;\n\n    config.webpack = function CssWebpackConfig(\n      config: Configuration,\n      context: any\n    ) {\n      config = nextConfigWebpack?.(config, context) ?? config;\n\n      config.module?.rules?.unshift(\n        {\n          type: 'javascript/esm',\n          test: /\\.css$/,\n          use: [\n            '@grexie/pages-style-loader',\n            {\n              loader: 'css-loader',\n              options: {\n                esModule: false,\n                sourceMap: true,\n              },\n            },\n          ],\n        },\n        {\n          type: 'javascript/esm',\n          test: /\\.css$/,\n          use: [\n            '@grexie/pages-style-loader',\n            {\n              loader: 'css-loader',\n              options: {\n                esModule: false,\n                sourceMap: true,\n              },\n            },\n          ],\n          include: /\\.global\\.css$/,\n        },\n        {\n          type: 'javascript/esm',\n          test: /\\.css$/,\n          use: [\n            '@grexie/pages-style-loader',\n            {\n              loader: 'css-loader',\n              options: {\n                esModule: false,\n                modules:\n                  process.env.NODE_ENV === 'production'\n                    ? true\n                    : {\n                        localIdentName:\n                          '[path][name]__[local]--[hash:base64:5]',\n                      },\n              },\n            },\n          ],\n          include: /\\.module\\.css$/,\n        }\n      );\n\n      return config;\n    };\n    return config;\n  };\n}\n"],"mappings":"AAIA,eAAe,SAASA,cAAcA,CAAA,EAAG;EACvC,OAAO,SAASC,aAAaA,CAACC,MAAkB,EAAE;IAChD,MAAMC,iBAAiB,GAAGD,MAAM,CAACE,OAAO;IAExCF,MAAM,CAACE,OAAO,GAAG,SAASC,gBAAgBA,CACxCH,MAAqB,EACrBI,OAAY,EACZ;MACAJ,MAAM,GAAGC,iBAAiB,GAAGD,MAAM,EAAEI,OAAO,CAAC,IAAIJ,MAAM;MAEvDA,MAAM,CAACK,MAAM,EAAEC,KAAK,EAAEC,OAAO,CAC3B;QACEC,IAAI,EAAE,gBAAgB;QACtBC,IAAI,EAAE,QAAQ;QACdC,GAAG,EAAE,CACH,4BAA4B,EAC5B;UACEC,MAAM,EAAE,YAAY;UACpBC,OAAO,EAAE;YACPC,QAAQ,EAAE,KAAK;YACfC,SAAS,EAAE;UACb;QACF,CAAC;MAEL,CAAC,EACD;QACEN,IAAI,EAAE,gBAAgB;QACtBC,IAAI,EAAE,QAAQ;QACdC,GAAG,EAAE,CACH,4BAA4B,EAC5B;UACEC,MAAM,EAAE,YAAY;UACpBC,OAAO,EAAE;YACPC,QAAQ,EAAE,KAAK;YACfC,SAAS,EAAE;UACb;QACF,CAAC,CACF;QACDC,OAAO,EAAE;MACX,CAAC,EACD;QACEP,IAAI,EAAE,gBAAgB;QACtBC,IAAI,EAAE,QAAQ;QACdC,GAAG,EAAE,CACH,4BAA4B,EAC5B;UACEC,MAAM,EAAE,YAAY;UACpBC,OAAO,EAAE;YACPC,QAAQ,EAAE,KAAK;YACfG,OAAO,EACLC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,YAAY,GACjC,IAAI,GACJ;cACEC,cAAc,EACZ;YACJ;UACR;QACF,CAAC,CACF;QACDL,OAAO,EAAE;MACX,CACF,CAAC;MAED,OAAOf,MAAM;IACf,CAAC;IACD,OAAOA,MAAM;EACf,CAAC;AACH"}